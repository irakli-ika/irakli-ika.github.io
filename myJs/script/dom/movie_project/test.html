<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
        <link rel="stylesheet" href="style/main.css">
        <title>Movies</title>
    </head>
    <body>
        <div class="search_box container mt-4">
            <input class="form-control col-md-5 mx-auto" id="input" type="text" placeholder="Search">
        </div>
        <div class="wrapper mt-5">
            <div class="container">
                <div class="row justify-content-around" id="main_row" >
                    <!-- TODO:: place for dinamic elements from JavaScript -->
                </div> <!-- ? end row -->
            </div><!--? end container -->
        </div><!--? end wrapper -->
        <!--? start pagination elements -->
        <div class="wrapper_pagination">
            <div class="container pagination_container mt-4 mx-auto">
                <nav aria-label="Page navigation example ">
                    <ul class="pagination justify-content-center">
                      <!-- <li class="page-item"><a class="page-link" href="#">1</a></li>
                      <li class="page-item"><a class="page-link" href="#">2</a></li>
                      <li class="page-item"><a class="page-link" href="#">3</a></li>
                      <li class="page-item"><a class="page-link" href="#">4</a></li> -->
                    </ul>
                </nav>
            </div>
        </div><!--? end pagination elements -->
        


        <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
        <script src="js/sql.js"></script>
        <script src="js/tempFunction.js"></script>
        <script src="js/filterFunction.js"></script>
        <script>
            const cols = []

            // call functions
                filterStructure()
                // pushInCols()
            // and call functions

            

            const pagination_element = document.querySelector('.pagination')
            const view = document.getElementById('main_row')

            let current_page = 1
            const rows = 3

            function display(items, view, row_per_page, page) {
                page--

                const start = row_per_page * page
                const end = start + row_per_page
                const sliceItems = items.slice(start, end)
                
                for(let i = 0; i < sliceItems.length; i++) {
                    const displayItem = sliceItems[i]
                    
                    cols.push(`<div class="main_col col-md-3 bg-secondary m-2 pt-2 rounded-lg">
                        <div class="content text-center">
                            <a href="page.html#${displayItem.id}" class="text-decoration-none">
                                <div class="movi_name">
                                    <h5 class="item">${displayItem.name}</h5>
                                </div>
                                <div class="movie_img">
                                    <img src="img/${displayItem.image}" alt="">
                                </div>
                                <div class="more text-right">
                                    <p>სრულად</p>
                                </div>
                            </a>
                        </div>
                    </div>`)
                }
            }

            function setupPagination(items, wrapper, row_per_page) {
                wrapper.innerHTML = ""

                const page_count = Math.ceil(items.length / row_per_page)
                for(let i = 1; i < page_count + 1; i++) {
                    const btn = paginationBtn(i, items)
                    wrapper.appendChild(btn)
                }
            }

            function paginationBtn(page, items){
                const createBtn = document.createElement('li')
                createBtn.classList.add('page-link', 'pointer')
                createBtn.innerText = page


                createBtn.addEventListener('click', (e) => {
                    current_page = page
                    display(items, view, rows, current_page)
                    console.log(current_page)
                })

                return createBtn

            }



            display(movies, view, rows, current_page)
            setupPagination(movies, pagination_element, rows)
            
            // document.getElementById('main_row').innerHTML = cols.map(element => element).join('')
        </script>
    </body>
</html>